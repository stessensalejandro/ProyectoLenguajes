 %%%%% Traduccion de Principal.java ,A.java,B.java y C.java

%%%--------------------Creacion de VTs-------------------------------------------- 

%%% Carga la VT de la clase A

 SetLabel VTA, Libre                                    %Creo la etiqueta para la VT de A
 SetD Libre, initA         @VTA: direccion de initA     %Pongo en la VTA la direccion de la version del initA que usa A 
 SetD Libre+1, m1A         @VTA: direccion de m1A       %Pongo en la VTA la direccion de la version de m1A que usa A 
 SetD Libre+2, m2A         @VTA: direccion de m2A       %Pongo en la VTA la direccion de la version de m2A que usa A 
 SetLibre Libre+4                                       %Actualizo Libre segun el tamaño de la VTA
 SetActual Libre                                        %Actualizo actual tambien
 
 %%% Carga la VT de la clase Principal
        SetLabel VTPrincipal, Libre                     %Creo la etiqueta para la VT de Principal
        SetLibre Libre+1                                %Actualizo Libre segun el tamaño de la VTA
        SetActual Libre                                 %Actualizo actual tambien
 
%%%----------------------------------------------------------------------------------
 

%%%-------------Codigo de Incializacion (Llamada a main)--------------------------
%%% Llama a main y finaliza
        SetD Libre, pc+5            @PTR    %Guardo puntero de retorno caigo em "Halt"
        SetD Libre+1, actual        @ED     %Guardo enlace dinamico %main es estatico asi que no tiene this!                                    
        SetActual Libre                     %Muevo actual para que apunte al RA que acabo de crear para main
        SetLibre Actual+5                   %Muevo libre segun el tamaño del RA de main (considerando las vars locales)
        Jump Main                           %Salto al codigo de main
        Halt                                %Cuando termino de ejecutar main finalizo

%----------------------------------------------------------------------------------
 
 
%%%--------------------Traduccion de initA de la clase A-------------------------
initA   SetH D[Actual+2]+1, D[Actual+3]     @x=p            %Guardo el valor del parametro p en x  a traves de this en el RA
        SetH D[Actual+2]+2, D[Actual+3]*5   @y=p*5          %Guardo el valor del parametro p*5 en y  a traves de this en el RA
        SetLibre Actual                                     %Limpio la memoria del RA de met2
        SetActual D[Libre+1]                                %Muevo Actual a donde tenia el enlase dinamico
        Jump D[Libre]                                       %Salto a la direccion de codigo que guarde en el puntero de retorno

%%%--------------------Traduccion de m1A de la clase A-----------------------------
m1A   SetH D[Actual+2]+1, D[Actual+3]     @x=p            %Guardo el valor del parametro p en x  a traves de this en el RA
        SetH D[Actual+2]+2, D[Actual+3]*5   @y=p*5          %Guardo el valor del parametro p*5 en y  a traves de this en el RA
        SetLibre Actual                                     %Limpio la memoria del RA de met2
        SetActual D[Libre+1]                                %Muevo Actual a donde tenia el enlase dinamico
        Jump D[Libre]                                       %Salto a la direccion de codigo que guarde en el puntero de retorno

%%%--------------------Traduccion de m2A de la clase A-----------------------------
m2A   SetH D[Actual+2]+1, D[Actual+3]     @x=p            %Guardo el valor del parametro p en x  a traves de this en el RA
        SetH D[Actual+2]+2, D[Actual+3]*5   @y=p*5          %Guardo el valor del parametro p*5 en y  a traves de this en el RA
        SetLibre Actual                                     %Limpio la memoria del RA de met2
        SetActual D[Libre+1]                                %Muevo Actual a donde tenia el enlase dinamico
        Jump D[Libre]                                       %Salto a la direccion de codigo que guarde en el puntero de retorno
%%%---------------------------------------------------------------------------------





%%%--------------------Traduccion de main de la clase Principal----------------------
   %% Creamos el Obj de clase A y lo guardamos en v
main    SetD Actual+2, PO         @v = new A()          %Guardo en v una ref al objeto que creo
        SetH PO, VTA            @Obj. Clase A - VTA     %Le agrego la VT al nuevo objeto 
        SetPO PO+3                                      %Incremento el PO segun el tamano de objeto que cree

    %% Leemos por pantalla el valor de i
        SetIn actual+3              @i=read()           %Leo el valor por pantalla y lo guardo en i
    
    %% Traduccion llamada v.met1(i)
        SetD Libre, PC+7            @PTR                %Guardo el puntero de retorno para volver de met1
        SetD Libre+1, Actual        @ED                 %Guardo enlace dinamico para al volver apuntar al RA de main
        SetD Libre+2, D[Actual+2]   @This               %Guardo this que en este caso es el objeto referenciado por v
        SetD Libre+3, D[Actual+3]   @param p            %Paso por parametro i
        SetActual Libre                                 %Muevo actual para que apunte al RA que acabo de crear para met1
        SetLibre  Actual+4                              %Muevo libre segun el tama�o del RA de met1
        Jump D[H[D[Actual+2]+0]+0]                      %Salto al codigo de met1 segun la VT del objeto receptor (el this del RA que acabo de crear)

  
 
%%%-----------------------------------------------------------------------------    